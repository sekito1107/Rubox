
> rubbit@1.0.0 test:unit
> vitest run


[1m[46m RUN [49m[22m [36mv4.0.18 [39m[90m/home/bonnmasa/app/rubpad[39m

 [32mâœ“[39m tests/unit/reference/resolve_signature.test.ts [2m([22m[2m9 tests[22m[2m)[22m[32m 11[2mms[22m[39m
 [31mâ¯[39m tests/unit/reference/index_searcher.test.ts [2m([22m[2m4 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 27[2mms[22m[39m
       [32mâœ“[39m ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ­£ã—ãèª­ã¿è¾¼ã‚ã‚‹ã“ã¨[32m 3[2mms[22m[39m
[31m       [31mÃ—[31m ã‚¨ãƒ©ãƒ¼æ™‚ã«ç©ºã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã§åˆæœŸåŒ–ã•ã‚Œã‚‹ã“ã¨[39m[32m 5[2mms[22m[39m
       [32mâœ“[39m findMethod ã§ãƒ¡ã‚½ãƒƒãƒ‰å€™è£œã‚’å–å¾—ã§ãã‚‹ã“ã¨[32m 1[2mms[22m[39m
       [32mâœ“[39m findMethodsByClass ã§ã‚¯ãƒ©ã‚¹ã«å±ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ä¸€è¦§ã‚’å–å¾—ã§ãã‚‹ã“ã¨[32m 15[2mms[22m[39m
 [31mâ¯[39m tests/unit/analysis/scanner.test.ts [2m([22m[2m12 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[32m 25[2mms[22m[39m
       [32mâœ“[39m ãƒ‰ãƒƒãƒˆè¨˜æ³•ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æ­£ã—ãæŠ½å‡ºã§ãã‚‹ã“ã¨[32m 5[2mms[22m[39m
       [32mâœ“[39m æ‹¬å¼§ä»˜ãã®ãƒ¡ã‚½ãƒƒãƒ‰å‘¼ã³å‡ºã—ã‚’æŠ½å‡ºã§ãã‚‹ã“ã¨[32m 0[2mms[22m[39m
       [32mâœ“[39m doãƒ–ãƒ­ãƒƒã‚¯ä»˜ãã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æŠ½å‡ºã§ãã‚‹ã“ã¨[32m 0[2mms[22m[39m
       [32mâœ“[39m ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã•ã‚ŒãŸè¡Œã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç„¡è¦–ã—ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ç¶­æŒã™ã‚‹ã“ã¨[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m ãƒ–ãƒ©ãƒƒã‚¯ãƒªã‚¹ãƒˆã«å«ã¾ã‚Œã‚‹ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’é™¤å¤–ã™ã‚‹ã“ã¨[39m[32m 10[2mms[22m[39m
       [32mâœ“[39m 1è¡Œã«è¤‡æ•°ã®ãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚ã‚‹å ´åˆã‚’å‡¦ç†ã§ãã‚‹ã“ã¨[32m 1[2mms[22m[39m
       [32mâœ“[39m Symbol#to_proc (&:method) æ§‹æ–‡ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æŠ½å‡ºã§ãã‚‹ã“ã¨[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m ãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆã«å«ã¾ã‚Œã‚‹æš—é»™çš„ãªãƒ¡ã‚½ãƒƒãƒ‰ (puts, p) ã‚’æŠ½å‡ºã§ãã‚‹ã“ã¨[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m å¼å±•é–‹ (#{...}) å†…ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æŠ½å‡ºã§ãã‚‹ã“ã¨[39m[32m 2[2mms[22m[39m
         [32mâœ“[39m æ§˜ã€…ãªé–‹å§‹ä½ç½®ã§æ­£ç¢ºã«ã‚«ãƒ©ãƒ ã‚’ç‰¹å®šã§ãã‚‹ã“ã¨[32m 1[2mms[22m[39m
         [32mâœ“[39m å¼å±•é–‹ãŒè¤‡æ•°ã‚ã‚‹å ´åˆã‚‚æ­£ã—ãä½ç½®ã‚’ç‰¹å®šã§ãã‚‹ã“ã¨[32m 1[2mms[22m[39m
         [32mâœ“[39m å˜èªã®é€”ä¸­ (Sum(ç­‰) ã‹ã‚‰æ„å›³ã—ãªã„ãƒãƒƒãƒ (um) ãŒç™ºç”Ÿã—ãªã„ã“ã¨[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/settings.test.ts [2m([22m[2m4 tests[22m[2m)[22m[32m 53[2mms[22m[39m
 [32mâœ“[39m tests/unit/examples.test.ts [2m([22m[2m5 tests[22m[2m)[22m[32m 52[2mms[22m[39m
 [32mâœ“[39m tests/unit/theme.test.ts [2m([22m[2m2 tests[22m[2m)[22m[32m 25[2mms[22m[39m
 [31mâ¯[39m tests/unit/analysis/resolver.test.ts [2m([22m[2m5 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 22[2mms[22m[39m
       [32mâœ“[39m LSP ã§ãƒ¡ã‚½ãƒƒãƒ‰ãŒç›´æ¥è§£æ±ºã•ã‚ŒãŸå ´åˆã€Rurima æƒ…å ±ã‚’è¿”ã™ã“ã¨[32m 7[2mms[22m[39m
       [32mâœ“[39m ç›´æ¥ã®è§£æ±ºãŒå¤±æ•—ã—ãŸå ´åˆã€ãƒ¬ã‚·ãƒ¼ãƒï¼ˆãƒ‰ãƒƒãƒˆã®å·¦ï¼‰ã®è§£æ±ºã‚’è©¦ã¿ã‚‹ã“ã¨ï¼ˆãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰[32m 2[2mms[22m[39m
       [32mâœ“[39m LSP ã§ã‚¯ãƒ©ã‚¹åã¯ç‰¹å®šã§ããŸãŒã€Rurima ã«è©²å½“ãŒãªã„å ´åˆã¯ unknown ã‚’è¿”ã™ã“ã¨[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã€unknown ã‚’è¿”ã—ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’å‡ºåŠ›ã™ã‚‹ã“ã¨[39m[32m 9[2mms[22m[39m
       [32mâœ“[39m æš—é»™çš„ãƒ¡ã‚½ãƒƒãƒ‰ (puts) ã®å ´åˆã€LSPè§£æ±ºã«å¤±æ•—ã—ã¦ã‚‚Kernelç­‰ã§ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯è§£æ±ºã™ã‚‹ã“ã¨[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/share.test.ts [2m([22m[2m4 tests[22m[2m)[22m[32m 87[2mms[22m[39m
 [32mâœ“[39m tests/unit/toast.test.ts [2m([22m[2m4 tests[22m[2m)[22m[32m 76[2mms[22m[39m
 [32mâœ“[39m tests/unit/editor.test.ts [2m([22m[2m5 tests[22m[2m)[22m[32m 48[2mms[22m[39m
 [32mâœ“[39m tests/unit/console.test.ts [2m([22m[2m6 tests[22m[2m)[22m[32m 279[2mms[22m[39m
 [32mâœ“[39m tests/unit/lsp/client.test.ts [2m([22m[2m5 tests[22m[2m)[22m[32m 16[2mms[22m[39m
 [32mâœ“[39m tests/unit/analysis/coordinator.test.ts [2m([22m[2m6 tests[22m[2m)[22m[32m 20[2mms[22m[39m
 [32mâœ“[39m tests/unit/lsp/diagnostics.test.ts [2m([22m[2m4 tests[22m[2m)[22m[32m 12[2mms[22m[39m
 [32mâœ“[39m tests/unit/ruby-vm.test.ts [2m([22m[2m5 tests[22m[2m)[22m[32m 26[2mms[22m[39m
 [32mâœ“[39m tests/unit/lsp/sync.test.ts [2m([22m[2m4 tests[22m[2m)[22m[32m 21[2mms[22m[39m
 [32mâœ“[39m tests/unit/persistence/share.test.ts [2m([22m[2m9 tests[22m[2m)[22m[32m 38[2mms[22m[39m
 [32mâœ“[39m tests/unit/header.test.ts [2m([22m[2m2 tests[22m[2m)[22m[32m 25[2mms[22m[39m
 [32mâœ“[39m tests/unit/runtime/exporter.test.ts [2m([22m[2m6 tests[22m[2m)[22m[32m 29[2mms[22m[39m
 [32mâœ“[39m tests/unit/download.test.ts [2m([22m[2m2 tests[22m[2m)[22m[32m 37[2mms[22m[39m
 [32mâœ“[39m tests/unit/analysis/store.test.ts [2m([22m[2m4 tests[22m[2m)[22m[32m 10[2mms[22m[39m
 [32mâœ“[39m tests/unit/persistence/settings.test.ts [2m([22m[2m5 tests[22m[2m)[22m[32m 12[2mms[22m[39m
 [32mâœ“[39m tests/unit/analysis/tracker.test.ts [2m([22m[2m5 tests[22m[2m)[22m[32m 6[2mms[22m[39m
 [32mâœ“[39m tests/unit/reference/fetch_method_list.test.ts [2m([22m[2m2 tests[22m[2m)[22m[32m 5[2mms[22m[39m
 [32mâœ“[39m tests/unit/persistence/code.test.ts [2m([22m[2m6 tests[22m[2m)[22m[32m 7[2mms[22m[39m
 [32mâœ“[39m tests/unit/lsp/parser.test.ts [2m([22m[2m11 tests[22m[2m)[22m[32m 6[2mms[22m[39m
 [32mâœ“[39m tests/unit/reference/url_generator.test.ts [2m([22m[2m7 tests[22m[2m)[22m[32m 4[2mms[22m[39m
 [32mâœ“[39m tests/unit/runtime/executor.test.ts [2m([22m[2m3 tests[22m[2m)[22m[32m 4[2mms[22m[39m

[31mâ¯â¯â¯â¯â¯â¯â¯[39m[1m[41m Failed Tests 5 [49m[22m[31mâ¯â¯â¯â¯â¯â¯â¯[39m

[41m[1m FAIL [22m[49m tests/unit/analysis/resolver.test.ts[2m > [22mResolver[2m > [22mresolve[2m > [22mã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã€unknown ã‚’è¿”ã—ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’å‡ºåŠ›ã™ã‚‹ã“ã¨
[31m[1mError[22m: LSP Error[39m
[36m [2mâ¯[22m tests/unit/analysis/resolver.test.ts:[2m70:63[22m[39m
    [90m 68| [39m      const consoleSpy = vi.spyOn(console, 'error').mockImplementationâ€¦
    [90m 69| [39m      [35mconst[39m resolution [33m=[39m resolver[33m.[39mresolution
    [90m 70| [39m      vi.mocked(resolution.resolveMethodAt).mockRejectedValue(new Erroâ€¦
    [90m   | [39m                                                              [31m^[39m
    [90m 71| [39m
    [90m 72| [39m      [35mconst[39m result [33m=[39m [35mawait[39m resolver[33m.[39m[34mresolve[39m([32m'error_method'[39m[33m,[39m [34m1[39m[33m,[39m [34m1[39m)

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[1/5]â¯[22m[39m

[41m[1m FAIL [22m[49m tests/unit/analysis/scanner.test.ts[2m > [22mScanner[2m > [22mscanLines[2m > [22mãƒ–ãƒ©ãƒƒã‚¯ãƒªã‚¹ãƒˆã«å«ã¾ã‚Œã‚‹ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’é™¤å¤–ã™ã‚‹ã“ã¨
[31m[1mAssertionError[22m: expected [ Array(1) ] to have a length of +0 but got 1[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 0[39m
[31m+ 1[39m

[36m [2mâ¯[22m tests/unit/analysis/scanner.test.ts:[2m72:30[22m[39m
    [90m 70| [39m      [34mexpect[39m(results[33m.[39m[35mget[39m([34m0[39m))[33m.[39m[34mtoHaveLength[39m([34m0[39m) [90m// if[39m
    [90m 71| [39m      [34mexpect[39m(results[33m.[39m[35mget[39m([34m1[39m))[33m.[39m[34mtoHaveLength[39m([34m0[39m) [90m// def[39m
    [90m 72| [39m      [34mexpect[39m(results[33m.[39m[35mget[39m([34m2[39m))[33m.[39m[34mtoHaveLength[39m([34m0[39m) [90m// class[39m
    [90m   | [39m                             [31m^[39m
    [90m 73| [39m      [34mexpect[39m(results[33m.[39m[35mget[39m([34m3[39m))[33m.[39m[34mtoHaveLength[39m([34m0[39m) [90m// end[39m
    [90m 74| [39m    })

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[2/5]â¯[22m[39m

[41m[1m FAIL [22m[49m tests/unit/analysis/scanner.test.ts[2m > [22mScanner[2m > [22mscanLines[2m > [22mãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆã«å«ã¾ã‚Œã‚‹æš—é»™çš„ãªãƒ¡ã‚½ãƒƒãƒ‰ (puts, p) ã‚’æŠ½å‡ºã§ãã‚‹ã“ã¨
[31m[1mAssertionError[22m: expected [ â€¦(2) ] to have a length of 1 but got 2[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 1[39m
[31m+ 2[39m

[36m [2mâ¯[22m tests/unit/analysis/scanner.test.ts:[2m108:21[22m[39m
    [90m106| [39m
    [90m107| [39m      [35mconst[39m line1 [33m=[39m results[33m.[39m[35mget[39m([34m0[39m)[33m![39m
    [90m108| [39m      [34mexpect[39m(line1)[33m.[39m[34mtoHaveLength[39m([34m1[39m)
    [90m   | [39m                    [31m^[39m
    [90m109| [39m      [34mexpect[39m(line1[[34m0[39m][33m.[39mname)[33m.[39m[34mtoBe[39m([32m'puts'[39m)
    [90m110| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[3/5]â¯[22m[39m

[41m[1m FAIL [22m[49m tests/unit/analysis/scanner.test.ts[2m > [22mScanner[2m > [22mscanLines[2m > [22må¼å±•é–‹ (#{...}) å†…ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æŠ½å‡ºã§ãã‚‹ã“ã¨
[31m[1mAssertionError[22m: expected [ â€¦(2) ] to have a length of 1 but got 2[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 1[39m
[31m+ 2[39m

[36m [2mâ¯[22m tests/unit/analysis/scanner.test.ts:[2m122:21[22m[39m
    [90m120| [39m
    [90m121| [39m      [35mconst[39m line1 [33m=[39m results[33m.[39m[35mget[39m([34m0[39m)[33m![39m
    [90m122| [39m      [34mexpect[39m(line1)[33m.[39m[34mtoHaveLength[39m([34m1[39m)
    [90m   | [39m                    [31m^[39m
    [90m123| [39m      [34mexpect[39m(line1[[34m0[39m][33m.[39mname)[33m.[39m[34mtoBe[39m([32m'upcase'[39m)
    [90m124| [39m      [34mexpect[39m(line1[[34m0[39m][33m.[39mcol)[33m.[39m[34mtoBe[39m([34m16[39m) [90m// "Hello, #{name.u... (1-indexed)[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[4/5]â¯[22m[39m

[41m[1m FAIL [22m[49m tests/unit/reference/index_searcher.test.ts[2m > [22mIndexSearcher[2m > [22mload[2m > [22mã‚¨ãƒ©ãƒ¼æ™‚ã«ç©ºã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã§åˆæœŸåŒ–ã•ã‚Œã‚‹ã“ã¨
[31m[1mError[22m: Server returned 404 for rurima_index.json[39m
[36m [2mâ¯[22m src/reference/index_searcher.ts:[2m34:15[22m[39m
    [90m 32| [39m
    [90m 33| [39m      [35mif[39m ([33m![39mindexRes[33m.[39mok) {
    [90m 34| [39m        throw new Error(`Server returned ${indexRes.status} for rurimaâ€¦
    [90m   | [39m              [31m^[39m
    [90m 35| [39m      }
    [90m 36| [39m      [35mif[39m ([33m![39minheritanceRes[33m.[39mok) {
[90m [2mâ¯[22m IndexSearcher.load src/reference/index_searcher.ts:[2m49:5[22m[39m
[90m [2mâ¯[22m tests/unit/reference/index_searcher.test.ts:[2m32:7[22m[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[5/5]â¯[22m[39m


[2m Test Files [22m [1m[31m3 failed[39m[22m[2m | [22m[1m[32m25 passed[39m[22m[90m (28)[39m
[2m      Tests [22m [1m[31m5 failed[39m[22m[2m | [22m[1m[32m141 passed[39m[22m[90m (146)[39m
[2m   Start at [22m 12:18:53
[2m   Duration [22m 4.35s[2m (transform 1.88s, setup 0ms, import 2.80s, tests 984ms, environment 31.07s)[22m

